{"version":3,"sources":["../../src/props/fulfillAPIRequest.js"],"names":["fulfillAPIRequest","req","appData","pageData","promises","then","query","_includeAppData","push","Promise","all","results","data","result","Object","assign"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;SAW8BA,iB;;;;;qGAAf,iBAAiCC,GAAjC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAwCC,YAAAA,OAAxC,QAAwCA,OAAxC,EAAiDC,QAAjD,QAAiDA,QAAjD;AACPC,YAAAA,QADO,GACI,CAACD,QAAQ,CAACF,GAAD,CAAR,CAAcI,IAAd,CAAmB,UAAAF,QAAQ;AAAA,qBAAK;AAAEA,gBAAAA,QAAQ,EAARA;AAAF,eAAL;AAAA,aAA3B,CAAD,CADJ;;AAGb,gBAAIF,GAAG,CAACK,KAAJ,CAAUC,eAAV,KAA8B,GAAlC,EAAuC;AACrCH,cAAAA,QAAQ,CAACI,IAAT,CAAcN,OAAO,CAACD,GAAD,CAAP,CAAaI,IAAb,CAAkB,UAAAH,OAAO;AAAA,uBAAK;AAAEA,kBAAAA,OAAO,EAAPA;AAAF,iBAAL;AAAA,eAAzB,CAAd;AACD;;AALY;AAAA,mBAOSO,OAAO,CAACC,GAAR,CAAYN,QAAZ,CAPT;;AAAA;AAOPO,YAAAA,OAPO;AAQPC,YAAAA,IARO,GAQA,EARA;AAAA,mDAUMD,OAVN;;AAAA;AAUb,kEAA4B;AAAnBE,gBAAAA,MAAmB;AAC1BC,gBAAAA,MAAM,CAACC,MAAP,CAAcH,IAAd,EAAoBC,MAApB;AACD;AAZY;AAAA;AAAA;AAAA;AAAA;;AAAA,6CAcND,IAdM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["/**\n * Creates an API response that contains app level data only when `?_includeAppData=1` is present in\n * the query string. Otherwise, the `appData` promise provided will not be resolved.\n *\n * @param {Request} req The request being served\n * @param {Object} options\n * @param {Function} options.appData An async function that returns a data for shared component in\n * the app such as menu, nav, and footer\n * @param {Function} options.pageData An async function that return data for the page component\n * @return {Object} the result of `appData` and `pageData` merged into a single object.\n */\nexport default async function fulfillAPIRequest(req, { appData, pageData }) {\n  const promises = [pageData(req).then(pageData => ({ pageData }))]\n\n  if (req.query._includeAppData === '1') {\n    promises.push(appData(req).then(appData => ({ appData })))\n  }\n\n  const results = await Promise.all(promises)\n  const data = {}\n\n  for (let result of results) {\n    Object.assign(data, result)\n  }\n\n  return data\n}\n"],"file":"fulfillAPIRequest.js"}