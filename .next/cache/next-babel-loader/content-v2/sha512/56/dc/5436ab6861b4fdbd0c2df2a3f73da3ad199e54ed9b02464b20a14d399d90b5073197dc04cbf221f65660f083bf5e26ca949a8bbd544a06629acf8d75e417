{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"C:/Users/sulur/Desktop/react-storefront/ui/react/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/sulur/Desktop/react-storefront/ui/react/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:/Users/sulur/Desktop/react-storefront/ui/react/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"C:/Users/sulur/Desktop/react-storefront/ui/react/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useContext, useState, useEffect, useRef } from 'react';\nimport clsx from 'clsx';\nimport qs from 'qs';\nimport useLazyState from 'react-storefront/hooks/useLazyState';\nimport Breadcrumbs from 'react-storefront/Breadcrumbs';\nimport CmsSlot from 'react-storefront/CmsSlot';\nimport MediaCarousel from 'react-storefront/carousel/MediaCarousel';\nimport PWAContext from 'react-storefront/PWAContext';\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Hidden from \"@material-ui/core/Hidden\";\nimport Button from \"@material-ui/core/Button\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\nimport Row from 'react-storefront/Row';\nimport { Hbox } from 'react-storefront/Box';\nimport Label from 'react-storefront/Label';\nimport Rating from 'react-storefront/Rating';\nimport get from 'lodash/get';\nimport fetch from 'react-storefront/fetch';\nimport { fetchLatest, StaleResponseError } from 'react-storefront/utils/fetchLatest';\nimport SessionContext from 'react-storefront/session/SessionContext';\nimport AddToCartConfirmation from '../../components/product/AddToCartConfirmation';\nimport SuggestedProducts from '../../components/product/SuggestedProducts';\nimport Lazy from 'react-storefront/Lazy';\nimport TabPanel from 'react-storefront/TabPanel';\nimport QuantitySelector from 'react-storefront/QuantitySelector';\nimport ProductOptionSelector from 'react-storefront/option/ProductOptionSelector';\nimport fetchFromAPI from 'react-storefront/props/fetchFromAPI';\nimport createLazyProps from 'react-storefront/props/createLazyProps';\nvar fetchVariant = fetchLatest(fetch);\n\nvar useDidMountEffect = function useDidMountEffect(func, deps) {\n  var didMount = useRef(false);\n  useEffect(function () {\n    if (didMount.current) {\n      func();\n    } else {\n      didMount.current = true;\n    }\n  }, deps);\n};\n\nvar styles = function styles(theme) {\n  return {\n    carousel: _defineProperty({}, theme.breakpoints.down('xs'), {\n      margin: theme.spacing(0, -2),\n      width: '100vw'\n    }),\n    lightboxCarousel: _defineProperty({}, theme.breakpoints.down('xs'), {\n      margin: 0,\n      width: '100%'\n    }),\n    confirmation: {\n      padding: '2px 0'\n    },\n    dockedSnack: _defineProperty({}, theme.breakpoints.down('xs'), {\n      left: '0',\n      bottom: '0',\n      right: '0'\n    }),\n    docked: _defineProperty({}, theme.breakpoints.down('xs'), {\n      fontSize: theme.typography.subtitle1.fontSize,\n      padding: \"\".concat(theme.spacing(2), \"px\"),\n      position: 'fixed',\n      left: 0,\n      bottom: 0,\n      width: '100%',\n      zIndex: 10,\n      borderRadius: '0'\n    }),\n    noShadow: _defineProperty({}, theme.breakpoints.down('xs'), {\n      boxShadow: 'none'\n    })\n  };\n};\n\nvar useStyles = makeStyles(styles);\nvar Product = /*#__PURE__*/React.memo(function (lazyProps) {\n  var theme = useTheme();\n\n  var _useState = useState(false),\n      confirmationOpen = _useState[0],\n      setConfirmationOpen = _useState[1];\n\n  var _useState2 = useState(false),\n      addToCartInProgress = _useState2[0],\n      setAddToCartInProgress = _useState2[1];\n\n  var _useLazyState = useLazyState(lazyProps, {\n    pageData: {\n      quantity: 1,\n      carousel: {\n        index: 0\n      }\n    }\n  }),\n      _useLazyState2 = _slicedToArray(_useLazyState, 2),\n      state = _useLazyState2[0],\n      updateState = _useLazyState2[1];\n\n  var classes = useStyles();\n  var product = get(state, 'pageData.product') || {};\n  var color = get(state, 'pageData.color') || {};\n  var size = get(state, 'pageData.size') || {};\n  var quantity = get(state, 'pageData.quantity');\n\n  var _useContext = useContext(SessionContext),\n      actions = _useContext.actions;\n\n  var loading = state.loading; // This is provided when <ForwardThumbnail> is wrapped around product links\n\n  var _useContext2 = useContext(PWAContext),\n      thumbnail = _useContext2.thumbnail; // Adds an item to the cart\n\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault(); // prevent the page location from changing\n\n              setAddToCartInProgress(true); // disable the add to cart button until the request is finished\n\n              _context.prev = 2;\n              _context.next = 5;\n              return actions.addToCart({\n                product: product,\n                quantity: quantity,\n                color: color.id,\n                size: size.id\n              });\n\n            case 5:\n              // open the confirmation dialog\n              setConfirmationOpen(true);\n\n            case 6:\n              _context.prev = 6;\n              // re-enable the add to cart button\n              setAddToCartInProgress(false);\n              return _context.finish(6);\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2,, 6, 9]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var header = /*#__PURE__*/_jsxs(Row, {\n    children: [/*#__PURE__*/_jsx(Typography, {\n      variant: \"h6\",\n      component: \"h1\",\n      gutterBottom: true,\n      children: product ? product.name : /*#__PURE__*/_jsx(Skeleton, {\n        style: {\n          height: '1em'\n        }\n      })\n    }), /*#__PURE__*/_jsxs(Hbox, {\n      children: [/*#__PURE__*/_jsx(Typography, {\n        style: {\n          marginRight: theme.spacing(2)\n        },\n        children: product.priceText\n      }), /*#__PURE__*/_jsx(Rating, {\n        value: product.rating,\n        reviewCount: 10\n      })]\n    })]\n  }); // Fetch variant data upon changing color or size options\n\n\n  useDidMountEffect(function () {\n    var query = qs.stringify({\n      color: color.id,\n      size: size.id\n    }, {\n      addQueryPrefix: true\n    });\n    fetchVariant(\"/api/p/\".concat(product.id).concat(query)).then(function (res) {\n      return res.json();\n    }).then(function (data) {\n      return updateState(_objectSpread(_objectSpread({}, state), {}, {\n        pageData: _objectSpread(_objectSpread({}, state.pageData), data.pageData)\n      }));\n    })[\"catch\"](function (e) {\n      if (!StaleResponseError.is(e)) {\n        throw e;\n      }\n    });\n  }, [color.id, size.id]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Breadcrumbs, {\n      items: !loading && state.pageData.breadcrumbs\n    }), /*#__PURE__*/_jsx(Container, {\n      maxWidth: \"lg\",\n      style: {\n        paddingTop: theme.spacing(2)\n      },\n      children: /*#__PURE__*/_jsxs(\"form\", {\n        onSubmit: handleSubmit,\n        method: \"post\",\n        \"action-xhr\": \"/api/cart\",\n        children: [/*#__PURE__*/_jsxs(Grid, {\n          container: true,\n          spacing: 4,\n          children: [/*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 12,\n            sm: 6,\n            md: 5,\n            children: [/*#__PURE__*/_jsx(Hidden, {\n              implementation: \"css\",\n              smUp: true,\n              children: header\n            }), /*#__PURE__*/_jsx(MediaCarousel, {\n              className: classes.carousel,\n              lightboxClassName: classes.lightboxCarousel,\n              thumbnail: thumbnail.current,\n              height: \"100%\",\n              media: color.media || product && product.media\n            })]\n          }), /*#__PURE__*/_jsx(Grid, {\n            item: true,\n            xs: 12,\n            sm: 6,\n            md: 7,\n            children: /*#__PURE__*/_jsxs(Grid, {\n              container: true,\n              spacing: 4,\n              children: [/*#__PURE__*/_jsxs(Grid, {\n                item: true,\n                xs: 12,\n                children: [/*#__PURE__*/_jsx(Hidden, {\n                  implementation: \"css\",\n                  xsDown: true,\n                  children: /*#__PURE__*/_jsx(\"div\", {\n                    style: {\n                      paddingBottom: theme.spacing(1)\n                    },\n                    children: header\n                  })\n                }), product ? /*#__PURE__*/_jsxs(_Fragment, {\n                  children: [/*#__PURE__*/_jsxs(Hbox, {\n                    style: {\n                      marginBottom: 10\n                    },\n                    children: [/*#__PURE__*/_jsx(Label, {\n                      children: \"COLOR: \"\n                    }), /*#__PURE__*/_jsx(Typography, {\n                      children: color.text\n                    })]\n                  }), /*#__PURE__*/_jsx(ProductOptionSelector, {\n                    options: product.colors,\n                    value: color,\n                    onChange: function onChange(value) {\n                      return updateState(_objectSpread(_objectSpread({}, state), {}, {\n                        pageData: _objectSpread(_objectSpread({}, state.pageData), {}, {\n                          color: value\n                        })\n                      }));\n                    },\n                    strikeThroughDisabled: true,\n                    optionProps: {\n                      showLabel: false\n                    }\n                  })]\n                }) : /*#__PURE__*/_jsxs(\"div\", {\n                  children: [/*#__PURE__*/_jsx(Skeleton, {\n                    style: {\n                      height: 14,\n                      marginBottom: theme.spacing(2)\n                    }\n                  }), /*#__PURE__*/_jsxs(Hbox, {\n                    children: [/*#__PURE__*/_jsx(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    }), /*#__PURE__*/_jsx(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    }), /*#__PURE__*/_jsx(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    })]\n                  })]\n                })]\n              }), /*#__PURE__*/_jsx(Grid, {\n                item: true,\n                xs: 12,\n                children: product ? /*#__PURE__*/_jsxs(_Fragment, {\n                  children: [/*#__PURE__*/_jsxs(Hbox, {\n                    style: {\n                      marginBottom: 10\n                    },\n                    children: [/*#__PURE__*/_jsx(Label, {\n                      children: \"SIZE: \"\n                    }), /*#__PURE__*/_jsx(Typography, {\n                      children: size.text\n                    })]\n                  }), /*#__PURE__*/_jsx(ProductOptionSelector, {\n                    options: product.sizes,\n                    value: size,\n                    strikeThroughDisabled: true,\n                    onChange: function onChange(value) {\n                      return updateState(_objectSpread(_objectSpread({}, state), {}, {\n                        pageData: _objectSpread(_objectSpread({}, state.pageData), {}, {\n                          size: value\n                        })\n                      }));\n                    }\n                  })]\n                }) : /*#__PURE__*/_jsxs(\"div\", {\n                  children: [/*#__PURE__*/_jsx(Skeleton, {\n                    style: {\n                      height: 14,\n                      marginBottom: theme.spacing(2)\n                    }\n                  }), /*#__PURE__*/_jsxs(Hbox, {\n                    children: [/*#__PURE__*/_jsx(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    }), /*#__PURE__*/_jsx(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    }), /*#__PURE__*/_jsx(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    })]\n                  })]\n                })\n              }), /*#__PURE__*/_jsx(Grid, {\n                item: true,\n                xs: 12,\n                children: /*#__PURE__*/_jsxs(Hbox, {\n                  children: [/*#__PURE__*/_jsx(Label, {\n                    children: \"QTY:\"\n                  }), /*#__PURE__*/_jsx(QuantitySelector, {\n                    value: quantity,\n                    onChange: function onChange(value) {\n                      return updateState(_objectSpread(_objectSpread({}, state), {}, {\n                        pageData: _objectSpread(_objectSpread({}, state.pageData), {}, {\n                          quantity: value\n                        })\n                      }));\n                    }\n                  })]\n                })\n              }), /*#__PURE__*/_jsxs(Grid, {\n                item: true,\n                xs: 12,\n                children: [/*#__PURE__*/_jsx(Button, {\n                  type: \"submit\",\n                  variant: \"contained\",\n                  color: \"primary\",\n                  size: \"large\",\n                  \"data-th\": \"add-to-cart\",\n                  className: clsx(classes.docked, classes.noShadow),\n                  disabled: addToCartInProgress,\n                  children: \"Add to Cart\"\n                }, \"button\"), /*#__PURE__*/_jsx(AddToCartConfirmation, {\n                  open: confirmationOpen,\n                  setOpen: setConfirmationOpen,\n                  product: product,\n                  color: color,\n                  size: size,\n                  quantity: quantity,\n                  price: product.priceText\n                })]\n              })]\n            })\n          })]\n        }), /*#__PURE__*/_jsx(Grid, {\n          item: true,\n          xs: 12,\n          children: /*#__PURE__*/_jsxs(TabPanel, {\n            children: [/*#__PURE__*/_jsx(CmsSlot, {\n              label: \"Description\",\n              children: product.description\n            }), /*#__PURE__*/_jsx(CmsSlot, {\n              label: \"Specs\",\n              children: product.specs\n            })]\n          })\n        }), /*#__PURE__*/_jsx(Grid, {\n          item: true,\n          xs: 12,\n          children: /*#__PURE__*/_jsx(Lazy, {\n            style: {\n              minHeight: 285\n            },\n            children: /*#__PURE__*/_jsx(SuggestedProducts, {\n              product: product\n            })\n          })\n        })]\n      })\n    })]\n  });\n});\nProduct.getInitialProps = createLazyProps(fetchFromAPI);\nexport default Product;","map":null,"metadata":{},"sourceType":"module"}